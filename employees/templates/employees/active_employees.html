{% extends 'employees/base.html' %}

{% block body %}
<div class="row mt-5">
  <div class="col-12">

    {% if employees %}
    <div class="card bg-light ms-4 me-4 mb-4">
      <div class="card-header d-flex justify-content-between align-items-center">
        <div>
          <i class="fa-solid fa-list fa-lg"></i> Active Employees
        </div>
        <a href="{% url 'add' %}" class="btn btn-outline-primary" role="button">
          <i class="fa-solid fa-plus"></i> Add Employee
        </a>
      </div>
      <div class="card-body">
        <div class="table-responsive">
          <table class="table table-hover">
            <thead>
            <tr>
              <th scope="col"><a
                      href="?sort=first_name&order={% if request.GET.sort == 'first_name' and request.GET.order == 'asc' %}desc{% else %}asc{% endif %}">First
                Name</a></th>
              <th scope="col"><a
                      href="?sort=last_name&order={% if request.GET.sort == 'last_name' and request.GET.order == 'asc' %}desc{% else %}asc{% endif %}">Last
                Name</a></th>
              <th scope="col"><a
                      href="?sort=department&order={% if request.GET.sort == 'department' and request.GET.order == 'asc' %}desc{% else %}asc{% endif %}">Department</a>
              </th>
              <th scope="col"><a
                      href="?sort=position&order={% if request.GET.sort == 'position' and request.GET.order == 'asc' %}desc{% else %}asc{% endif %}">Position</a>
              </th>
              <th scope="col">Actions</th>
            </tr>
            </thead>
            <tbody>
            {% for employee in employees %}
            <tr>
              <td>{{ employee.first_name }}</td>
              <td>{{ employee.last_name }}</td>
              <td>{{ employee.department }}</td>
              <td>{{ employee.position }}</td>
              <td>
                <button type="button" class="btn btn-info me-1" data-bs-toggle="modal"
                        data-bs-target="#myModal{{employee.id}}">
                  <i class="fa-solid fa-circle-info fa-lg"></i>
                </button>

                <div class="modal" id="myModal{{employee.id}}" tabindex="-1" aria-labelledby="modalLabel{{employee.id}}"
                     aria-hidden="true">
                  <div class="modal-dialog" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h5 class="modal-title" id="modalLabel{{employee.id}}">
                          {{ employee.first_name }} {{ employee.last_name }}
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                      </div>
                      <div class="modal-body">
                        <table class="table">
                          <tbody>
                          <tr>
                            <th scope="row">Department</th>
                            <td>{{ employee.department }}</td>
                          </tr>
                          <tr>
                            <th scope="row">Position</th>
                            <td>{{ employee.position }}</td>
                          </tr>
                          <tr>
                            <th scope="row">Date Of Birth</th>
                            <td>{{ employee.employee_information.date_of_birth }}</td>
                          </tr>
                          <tr>
                            <th scope="row">Email</th>
                            <td>{{ employee.employee_information.email }}</td>
                          </tr>
                          <tr>
                            <th scope="row">Phone</th>
                            <td>{{ employee.employee_information.phone_number }}</td>
                          </tr>
                          <tr>
                            <th scope="row">Address</th>
                            <td>{{ employee.employee_information.street }}</td>
                          </tr>
                          <tr>
                            <th scope="row">City</th>
                            <td>{{ employee.employee_information.city }}</td>
                          </tr>
                          <tr>
                            <th scope="row">ZIP code</th>
                            <td>{{ employee.employee_information.zip_code }}</td>
                          </tr>
                          <tr>
                            <th scope="row">Country</th>
                            <td>{{ employee.employee_information.country }}</td>
                          </tr>
                          </tbody>
                        </table>
                      </div>
                      <div class="modal-footer">
                        <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Close</button>
                      </div>
                    </div>
                  </div>
                </div>

                <a class="btn btn-warning me-1" href="{% url 'edit_employee' employee.id %}">
                  <i class="fa-solid fa-user-pen fa-lg"></i>
                </a>
                <button type="button" class="btn btn-danger" data-bs-toggle="modal"
                        data-bs-target="#deleteModal{{employee.id}}">
                  <i class="fa-solid fa-user-minus fa-lg"></i>
                </button>

                <div class="modal" id="deleteModal{{employee.id}}" tabindex="-1" aria-labelledby="modalLabel2"
                     aria-hidden="true">
                  <div class="modal-dialog" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h5 class="modal-title">
                          {{ employee.first_name }} {{ employee.last_name }}
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                      </div>
                      <div class="modal-body">
                        <p>Are you sure you want to deactivate {{ employee.first_name }} {{ employee.last_name }}?</p>
                      </div>
                      <div class="modal-footer">
                        <form action="{% url 'delete' employee.id %}" method="POST">
                          {% csrf_token %}
                          <input type="submit" class="btn btn-danger" value="Make Inactive">
                          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        </form>
                      </div>
                    </div>
                  </div>
                </div>
              </td>
            </tr>
            {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
    {% else %}
    <h5 class="alert alter-primary ms-4 me-4 mb-4">No Employees Found</h5>
    {% endif %}
  </div>
</div>
{% endblock %}






